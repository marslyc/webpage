import{O as X,V as B,c as p,t as F,T as Y,R as Z,r as $,S as ee,q as te,p as ne,U as z,ah as A,M as H,d as ie,B as re,L as se,w as oe,W as ae,l as le}from"./three.module-BUZdne6h.js";import{O as de}from"./OrbitControls-UBkTBaol.js";import{r as ce,o as me,h as he,c as ue,a as pe}from"./index-E0VyOJT8.js";class E extends X{constructor(l=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=l,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new B(.5,.5),this.addEventListener("removed",function(){this.traverse(function(i){i.element instanceof Element&&i.element.parentNode!==null&&i.element.parentNode.removeChild(i.element)})})}copy(l,i){return super.copy(l,i),this.element=l.element.cloneNode(!0),this.center=l.center,this}}const f=new p,P=new F,T=new F,U=new p,N=new p;class we{constructor(l={}){const i=this;let o,c,a,x;const h={objects:new WeakMap},d=l.element!==void 0?l.element:document.createElement("div");d.style.overflow="hidden",this.domElement=d,this.getSize=function(){return{width:o,height:c}},this.render=function(e,t){e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),P.copy(t.matrixWorldInverse),T.multiplyMatrices(t.projectionMatrix,P),m(e,e,t),y(e)},this.setSize=function(e,t){o=e,c=t,a=o/2,x=c/2,d.style.width=e+"px",d.style.height=t+"px"};function w(e){e.isCSS2DObject&&(e.element.style.display="none");for(let t=0,s=e.children.length;t<s;t++)w(e.children[t])}function m(e,t,s){if(e.visible===!1){w(e);return}if(e.isCSS2DObject){f.setFromMatrixPosition(e.matrixWorld),f.applyMatrix4(T);const n=f.z>=-1&&f.z<=1&&e.layers.test(s.layers)===!0,r=e.element;r.style.display=n===!0?"":"none",n===!0&&(e.onBeforeRender(i,t,s),r.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(f.x*a+a)+"px,"+(-f.y*x+x)+"px)",r.parentNode!==d&&d.appendChild(r),e.onAfterRender(i,t,s));const u={distanceToCameraSquared:S(s,e)};h.objects.set(e,u)}for(let n=0,r=e.children.length;n<r;n++)m(e.children[n],t,s)}function S(e,t){return U.setFromMatrixPosition(e.matrixWorld),N.setFromMatrixPosition(t.matrixWorld),U.distanceToSquared(N)}function g(e){const t=[];return e.traverseVisible(function(s){s.isCSS2DObject&&t.push(s)}),t}function y(e){const t=g(e).sort(function(n,r){if(n.renderOrder!==r.renderOrder)return r.renderOrder-n.renderOrder;const u=h.objects.get(n).distanceToCameraSquared,v=h.objects.get(r).distanceToCameraSquared;return u-v}),s=t.length;for(let n=0,r=t.length;n<r;n++)t[n].element.style.zIndex=s-n}}}const ve={__name:"Earth",setup(O){let l=ce(),i,o,c,a,x=new le,h=new Y,d,w,m,S,g=new Z;y(),t();function y(){o=new $(45,window.innerWidth/window.innerHeight,.1,200),o.position.set(0,5,-10),i=new ee;const r=new te(16777215);r.position.set(0,0,1),i.add(r);const u=new ne(16777215,.5);i.add(u);let v=new URL("/assets/earth_atmos_2048-d1pdJ3jg.jpg",import.meta.url).href,_=new URL("/assets/earth_specular_2048-6aAFN27D.jpg",import.meta.url).href,R=new URL("/assets/earth_normal_2048-BD2vMuPH.jpg",import.meta.url).href;const q=new z(1,16,16),I=new A({specular:3355443,shininess:5,map:h.load(v),specularMap:h.load(_),normalMap:h.load(R),normalScale:new B(.85,.85)});w=new H(q,I),i.add(w);let k=new URL("/assets/moon_1024-D_Wp7Gh9.jpg",import.meta.url).href;const G=new z(.27,16,16),j=new A({shininess:5,map:h.load(k)});d=new H(G,j),i.add(d),S=new ie([new p(-5,0,5),new p(-5,5,5),new p(0,0,5),new p(5,-5,5),new p(5,0,5)],!0);let V=S.getPoints(50),J=new re().setFromPoints(V),K=new se({color:16777215}),Q=new oe(J,K);i.add(Q);const M=document.createElement("div");M.className="label",M.innerHTML="地球";const C=new E(M);C.position.set(0,1,0),w.add(C);const D=document.createElement("div");D.className="label1",D.innerHTML="中国",m=new E(D),m.position.set(-.3,.5,-.9),w.add(m);const L=document.createElement("div");L.className="label",L.innerHTML="月球";const W=new E(L);W.position.set(0,.3,0),d.add(W),a=new we,a.setSize(window.innerWidth,window.innerHeight),a.domElement.style.position="absolute",a.domElement.style.top="0px",a.domElement.style.left="0px",a.domElement.style.zIndex="10",c=new ae,c.setPixelRatio(window.devicePixelRatio),c.setSize(window.innerWidth,window.innerHeight),me(()=>{l.value.appendChild(a.domElement),l.value.appendChild(c.domElement)});const b=new de(o,a.domElement);b.minDistance=5,b.maxDistance=100,window.addEventListener("resize",e),he(()=>{window.removeEventListener("resize",e)})}function e(){o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),c.setSize(window.innerWidth,window.innerHeight),a.setSize(window.innerWidth,window.innerHeight)}function t(){requestAnimationFrame(t);const s=x.getElapsedTime(),n=m.position.clone(),r=n.distanceTo(o.position);n.project(o),g.setFromCamera(n,o);const u=g.intersectObjects(i.children,!0);u.length==0?m.element.classList.add("visible"):u[0].distance<r?m.element.classList.remove("visible"):m.element.classList.add("visible");const v=s/10%1,_=S.getPoint(v);d.position.copy(_),a.render(i,o),c.render(i,o)}return(s,n)=>(pe(),ue("div",{id:"box1",class:"earthScene",ref_key:"earthScene",ref:l},null,512))}};export{ve as default};
